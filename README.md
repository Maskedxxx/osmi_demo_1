# Анализ дефектов строительных работ

Telegram-бот для автоматического анализа PDF с экспертизами строительных работ. Извлекает текст, находит дефекты через ИИ и создает Excel отчет.

## Использование

1. Запустите бота командой `/start`
2. Нажмите кнопку "Загрузить документ"
3. Отправьте ссылку на PDF из Google Drive

Бот автоматически выполнит анализ в 4 этапа:
- **OCR** - извлечение текста из PDF (~4-5 минут)
- **Семантический анализ** - поиск страниц с дефектами (~30 секунд)  
- **Очистка через Vision LM** - улучшение качества текста (~1-2 минуты)
- **Формирование таблицы** - извлечение дефектов в Excel (~1 минута)

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Создайте файл `.env`:
```
BOT_TOKEN=ваш_токен_бота
OPENAI_API_KEY=ваш_openai_ключ
```

3. Запустите бота:
```bash
python main.py
```

## Результат

Бот отправит Excel файл с таблицей найденных дефектов, содержащей:
- Текст из экспертизы
- Помещение 
- Локализация
- Описание дефекта
- Тип работ для устранения

## Требования

- Токен Telegram бота от @BotFather
- OpenAI API ключ
- PDF должен быть доступен по ссылке Google Drive