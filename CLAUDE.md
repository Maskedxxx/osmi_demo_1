# CLAUDE.md

Руководство для Claude Code при совместной работе над проектом.

## 0. Принципы работы

**ВАЖНО**: Всегда общайся с пользователем на русском языке.

**ВАЖНО**: Реализуй только то, что явно запрошено. Не добавляй ничего лишнего без утверждения.

**Архитектура**: Придерживайся простоты — один файл для одной цели, минимум абстракций, максимум читаемости.

## 1. Стиль кода

### Простота превыше всего
- Избегай преждевременного разделения на модули
- Используй типизацию для ясности: `def handle_message(message: Message) -> None`
- Функции должны делать одно дело и иметь понятные имена
- Максимум 200 строк на функцию

### Конфигурация
- Все настройки в `config.py`
- Секреты через переменные окружения
- Токены **никогда** не хардкодим в коде

### Обработка ошибок
- Всегда логируй ошибки с контекстом
- Показывай пользователю понятные сообщения об ошибках
- Обрабатывай исключения aiogram корректно

## 2. Безопасность и качество

### Общие правила безопасности
- Секреты только через переменные окружения
- Токены **никогда** не хардкодим в коде
- Проверяй размер и типы загружаемых файлов
- Очищай пользовательский ввод от опасных символов

### Проверка кода
- Перед коммитом проверь код на базовые ошибки
- Используй `python -m py_compile` для проверки синтаксиса

## 3. Принципы поддержания качества

### Перед любыми изменениями
1. Изучи существующий код и его паттерны
2. Следуй уже установленному стилю
3. Не ломай работающий функционал

### При добавлении нового функционала
1. Сначала реализуй минимально работающую версию
2. Тестируй вручную через бота
3. Добавляй обработку ошибок

### Логирование
- Используй `logging` вместо `print`
- Логируй важные события: начало обработки, ошибки, завершение
- Уровни: INFO для событий, ERROR для ошибок

## 4. Рабочий процесс

### План работы LLM агента
1. **Пойми задачу** — проанализируй текущий код
2. **Составь план** — опиши что будешь делать
3. **Реализуй пошагово** — делай по одному изменению
4. **Проверь результат** — убедись что все работает

### Недопустимо
- Переписывать рабочий код без необходимости
- Добавлять сложные абстракции для простых задач
- Удалять или изменять существующие обработчики без причины
- Коммитить код с ошибками или предупреждениями

## 5. Документация

### Обязательное обновление документации
- **ВСЕГДА** обновляй README.md перед коммитом новых функций
- Документируй все новые возможности и изменения API
- Указывай инструкции по установке и использованию
- Описывай архитектурные решения и их обоснование